<svg width="1200" height="950" viewBox="0 0 1200 950" xmlns="http://www.w3.org/2000/svg" style="background-color: #0c0a24; font-family: 'Segoe UI', Roboto, sans-serif;">
    <defs>
        <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#0f0c29; stop-opacity:1" />
            <stop offset="50%" style="stop-color:#24243e; stop-opacity:1" />
            <stop offset="100%" style="stop-color:#0f0c29; stop-opacity:1" />
        </linearGradient>
        <linearGradient id="nodeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" style="stop-color:#2c2c54; stop-opacity:0.8" />
            <stop offset="100%" style="stop-color:#1a1a3e; stop-opacity:0.9" />
        </linearGradient>
        <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
            <feMerge>
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
            </feMerge>
        </filter>
        <marker id="arrow" viewBox="0 0 10 10" refX="8" refY="5"
            markerWidth="6" markerHeight="6"
            orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#5eadf2" />
        </marker>
        <marker id="arrow-purple" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#ba38f2" />
        </marker>
        <marker id="arrow-pink" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#ff1493" />
        </marker>
         <marker id="arrow-blue" viewBox="0 0 10 10" refX="8" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#04adbf" />
        </marker>
    </defs>

    <rect width="100%" height="100%" fill="url(#bgGradient)" />

    <g id="connections" fill="none">
        <path id="p1" d="M 250 100 Q 375 170, 490 230" stroke="#5eadf2" stroke-width="1.5" stroke-dasharray="5, 5" marker-end="url(#arrow)"/>
        <path id="p2" d="M 250 250 L 490 260" stroke="#5eadf2" stroke-width="1.5" stroke-dasharray="5, 5" marker-end="url(#arrow)"/>
        <path id="p3" d="M 250 400 Q 375 330, 490 290" stroke="#5eadf2" stroke-width="1.5" stroke-dasharray="5, 5" marker-end="url(#arrow)"/>
        
        <path id="p4" d="M 550 290 C 500 400, 250 450, 125 565" stroke="#ba38f2" stroke-width="1.5" marker-end="url(#arrow-purple)"/>
        <path id="p5" d="M 575 290 C 525 450, 325 550, 275 665" stroke="#ba38f2" stroke-width="1.5" marker-end="url(#arrow-purple)"/>
        <path id="p6" d="M 650 290 C 700 400, 900 450, 875 565" stroke="#ba38f2" stroke-width="1.5" marker-end="url(#arrow-purple)"/>
        <path id="p7" d="M 625 290 C 675 450, 975 550, 1025 665" stroke="#ba38f2" stroke-width="1.5" marker-end="url(#arrow-purple)"/>
        
        <path id="p8" d="M 200 600 L 475 605" stroke="#ff1493" stroke-width="2" marker-end="url(#arrow-pink)"/>
        <path id="p9" d="M 350 700 L 475 655" stroke="#ff1493" stroke-width="2" marker-end="url(#arrow-pink)"/>
        <path id="p10" d="M 800 600 L 725 605" stroke="#ff1493" stroke-width="2" marker-end="url(#arrow-pink)"/>
        <path id="p11" d="M 950 700 L 725 655" stroke="#ff1493" stroke-width="2" marker-end="url(#arrow-pink)"/>

        <path id="p12" d="M 600 480 L 600 390" stroke="#5eadf2" stroke-width="2.5" marker-end="url(#arrow)"/>
        <path id="p13" d="M 600 290 L 600 190" stroke="#ba38f2" stroke-width="2" marker-end="url(#arrow-purple)"/>
        
        <!-- CORRECTED: Combined feedback loop path -->
        <path id="p_feedback" d="M 710 140 C 950 140, 1100 350, 1100 550 L 1090 740" stroke="#04adbf" stroke-width="1.5" stroke-dasharray="4, 4" marker-end="url(#arrow-blue)"/>
    </g>
    
    <g>
        <circle r="3.5" fill="#5eadf2" filter="url(#glow)"> <animateMotion dur="5s" repeatCount="indefinite"><mpath href="#p1"/></animateMotion> </circle>
        <circle r="3.5" fill="#5eadf2" filter="url(#glow)"> <animateMotion dur="4s" repeatCount="indefinite" begin="0.2s"><mpath href="#p2"/></animateMotion> </circle>
        <circle r="3.5" fill="#5eadf2" filter="url(#glow)"> <animateMotion dur="6s" repeatCount="indefinite" begin="0.4s"><mpath href="#p3"/></animateMotion> </circle>

        <circle r="3" fill="#ba38f2"> <animateMotion dur="3s" repeatCount="indefinite"><mpath href="#p4"/></animateMotion> </circle>
        <circle r="3" fill="#ba38f2"> <animateMotion dur="3.2s" repeatCount="indefinite" begin="0.3s"><mpath href="#p5"/></animateMotion> </circle>
        <circle r="3" fill="#ba38f2"> <animateMotion dur="3.1s" repeatCount="indefinite" begin="0.6s"><mpath href="#p6"/></animateMotion> </circle>
        <circle r="3" fill="#ba38f2"> <animateMotion dur="3.3s" repeatCount="indefinite" begin="0.9s"><mpath href="#p7"/></animateMotion> </circle>
        
        <circle r="4" fill="#ff1493" filter="url(#glow)"> <animateMotion dur="2s" repeatCount="indefinite"><mpath href="#p8"/></animateMotion> </circle>
        <circle r="4" fill="#ff1493" filter="url(#glow)"> <animateMotion dur="2.1s" repeatCount="indefinite" begin="0.2s"><mpath href="#p9"/></animateMotion> </circle>
        <circle r="4" fill="#ff1493" filter="url(#glow)"> <animateMotion dur="2.2s" repeatCount="indefinite" begin="0.4s"><mpath href="#p10"/></animateMotion> </circle>
        <circle r="4" fill="#ff1493" filter="url(#glow)"> <animateMotion dur="2.3s" repeatCount="indefinite" begin="0.6s"><mpath href="#p11"/></animateMotion> </circle>
        
        <circle r="5" fill="white" filter="url(#glow)"> <animateMotion dur="2.5s" begin="0.5s" repeatCount="indefinite"><mpath href="#p12"/></animateMotion> </circle>
        <circle r="4" fill="#5eadf2"> <animateMotion dur="3s" begin="1s" repeatCount="indefinite"><mpath href="#p13"/></animateMotion> </circle>
        
        <!-- CORRECTED: Single animation for single feedback path -->
        <circle r="2.5" fill="#04adbf"> <animateMotion dur="7s" repeatCount="indefinite"><mpath href="#p_feedback"/></animateMotion> </circle>
    </g>

    <g fill="white" text-anchor="middle">
        <g transform="translate(50, 70)">
            <rect width="200" height="60" rx="10" fill="url(#nodeGradient)" stroke="#5eadf2" stroke-width="2"/>
            <text x="100" y="30" font-size="14" font-weight="bold">SAP Security Notes</text>
            <text x="100" y="48" font-size="12" fill="#ccc">(Patch Day)</text>
        </g>
        <g transform="translate(50, 220)">
            <rect width="200" height="60" rx="10" fill="url(#nodeGradient)" stroke="#5eadf2" stroke-width="2"/>
            <text x="100" y="30" font-size="14" font-weight="bold">Public CVE Databases</text>
            <text x="100" y="48" font-size="12" fill="#ccc">(NVD, Mitre)</text>
        </g>
        <g transform="translate(50, 370)">
            <rect width="200" height="60" rx="10" fill="url(#nodeGradient)" stroke="#5eadf2" stroke-width="2"/>
            <text x="100" y="30" font-size="14" font-weight="bold">Threat Intelligence</text>
            <text x="100" y="48" font-size="12" fill="#ccc">(EPSS, KEV)</text>
        </g>

        <!-- CORRECTED: Centered Node -->
        <g transform="translate(500, 230)">
            <rect width="200" height="60" rx="30" fill="url(#nodeGradient)" stroke="#ba38f2" stroke-width="2.5" filter="url(#glow)"/>
            <text x="100" y="35" font-size="15" font-weight="bold">Data Aggregation</text>
        </g>

        <g transform="translate(50, 570)">
            <rect width="150" height="60" rx="8" fill="url(#nodeGradient)" stroke="#ff1493" stroke-width="2"/>
            <text x="75" y="30" font-size="14">KEV Catalog</text>
            <text x="75" y="50" font-size="16" fill="#ff1493" font-weight="bold">Weight: 3</text>
        </g>
        <g transform="translate(200, 670)">
            <rect width="150" height="60" rx="8" fill="url(#nodeGradient)" stroke="#ff1493" stroke-width="2"/>
            <text x="75" y="30" font-size="14">CVSS Score</text>
            <text x="75" y="50" font-size="16" fill="#ff1493" font-weight="bold">Weight: 2x</text>
        </g>
        <g transform="translate(800, 570)">
            <rect width="150" height="60" rx="8" fill="url(#nodeGradient)" stroke="#ff1493" stroke-width="2"/>
            <text x="75" y="25" font-size="14">EPSS Score</text>
            <text x="75" y="40" font-size="12" fill="#ccc">(+ Trend Analysis)</text>
            <text x="75" y="55" font-size="16" fill="#ff1493" font-weight="bold">Weight: 1-3x</text>
        </g>
        <g transform="translate(950, 670)">
            <rect width="150" height="60" rx="8" fill="url(#nodeGradient)" stroke="#ff1493" stroke-width="2"/>
            <text x="75" y="30" font-size="14">CWE Top 25</text>
            <text x="75" y="50" font-size="16" fill="#ff1493" font-weight="bold">Weight: 1.5x</text>
        </g>

        <g transform="translate(600, 620)">
            <polygon points="0,-140 121,-70 121,70 0,140 -121,70 -121,-70" fill="url(#nodeGradient)" stroke="#ff1493" stroke-width="4" filter="url(#glow)"/>
            <text y="-50" font-size="20" font-weight="bold">Rethink Priority</text>
            <text y="-25" font-size="18" font-weight="bold" fill="#ff1493">Score Model</text>
            <text y="20" font-size="12" fill="#ccc">Composite Score =</text>
            <text y="40" font-size="11" fill="#ddd">(KEV*3) + (CVSS*2) +</text>
            <text y="58" font-size="11" fill="#ddd">(EPSS*w) + (CWE*1.5) + 1</text>
        </g>
        
        <g transform="translate(500, 300)">
            <rect width="200" height="80" rx="10" fill="url(#nodeGradient)" stroke="#5eadf2" stroke-width="2.5" filter="url(#glow)"/>
            <text x="100" y="35" font-size="16" font-weight="bold">Ranked</text>
            <text x="100" y="55" font-size="16" font-weight="bold">Vulnerability List</text>
        </g>
        
        <g transform="translate(500, 100)">
            <rect width="200" height="80" rx="10" fill="url(#nodeGradient)" stroke="#ba38f2" stroke-width="2"/>
            <text x="100" y="35" font-size="14">Strategic Patching Plan</text>
            <text x="100" y="55" font-size="14" fill="#ccc">&amp; DevSecOps Pipelines</text>
        </g>

        <g transform="translate(1000, 750)">
            <rect width="180" height="120" rx="10" fill="url(#nodeGradient)" stroke="#04adbf" stroke-width="2"/>
            <text x="90" y="20" font-size="14" font-weight="bold" fill="#04adbf">Validation Metrics</text>
            <text x="90" y="45" font-size="12">- Precision at Top</text>
            <text x="90" y="65" font-size="12">- MTTP Reduction</text>
            <text x="90" y="85" font-size="12">- Incident Correlation</text>
            <text x="90" y="105" font-size="12">- Feedback Loop</text>
        </g>
    </g>
</svg>
